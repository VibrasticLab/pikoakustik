#!/usr/bin/python3
# -*- coding: utf-8 -*-

import numpy as np
from scipy import fftpack
import matplotlib.pyplot as plt

fs = 44100
x = np.array([-12.779474,-12.71826, -12.608218,-12.471533,-12.316561, -12.112034,-11.859476,-11.577236,-11.262215,-10.930813, -10.490394,-10.082054, -9.616923, -9.138489, -8.623147,  -8.049477, -7.460618, -6.82379,  -6.1481357,-5.4267645,  -4.780233, -4.0254235,-3.3054233,-2.6019096,-1.8839717,  -1.14398,  -0.41134357,0.3098011, 1.0598421, 1.822412,2.5776267, 3.2870173, 3.9726973, 4.6311975, 5.303395,5.9526443, 6.546879,  7.158971,  7.7534676, 8.293354,8.838951,  9.311652,  9.803772, 10.198582, 10.559034,  10.910678, 11.215771, 11.49528,  11.752272, 11.980271,  12.168205, 12.313032, 12.3575325,12.340236, 12.278688,  12.167967, 12.016821, 11.840141, 11.617338, 11.360645,  11.029589, 10.662758, 10.252846,  9.791136,  9.350467,8.868277,  8.3606, 7.8487754, 7.293141,  6.7364335,6.149256,  5.522084,  4.8461795, 4.17037,3.4461498,2.7300358, 2.0006418, 1.238513,  0.47152042  -0.2778411,  -1.0267615,-1.7618895,-2.4679303,-3.1803846,-3.904581,  -4.591334, -5.2539825,-5.910456, -6.537509, -7.132101,  -7.7216864,-8.251309, -8.741987, -9.220052, -9.663332, -10.084068,-10.485721,-10.836208,-11.153114,-11.449373, -11.66594, -11.814213,-11.939203,-12.020361,-12.036287, -12.027824,-12.010956,-11.965906,-11.868596,-11.727834, -11.54896, -11.335778,-10.998642,-10.681021,-10.273433,  -9.818959, -9.309971, -8.817458, -8.266651, -7.687676,  -7.104969, -6.450224, -5.81733,  -5.1276684,-4.4365764,  -3.724575, -2.988255, -2.2966146,-1.6165257,-0.9002328,  -0.20347834,0.49090385,1.2073636, 1.9355178, 2.7132392,3.4767509, 4.203558,  4.9913526, 5.6749463, 6.3817024,7.0468307, 7.673764,  8.310568,  8.850408,  9.444761,9.999752, 10.490597, 10.984874, 11.398613, 11.744415,  12.093258, 12.41765,  12.63485,  12.852037, 13.006651,  13.113594, 13.17972,  13.261867, 13.252449, 13.167167,  13.078844, 12.930668, 12.748182, 12.509287, 12.218559,  11.901129, 11.523497, 11.1444,10.715759, 10.281086,9.78961,9.236038,  8.679068,  8.078694,  7.455492,6.7942142, 6.14866,5.503559,  4.7959805, 4.080057,3.3608198, 2.6275635, 1.8912792, 1.1604548, 0.4407525,  -0.2544403,-0.9472728,-1.6461372,-2.3361444,-3.0279875,  -3.6831737,-4.3306828,-5.020833, -5.6403637,-6.2296987,  -6.831193, -7.38765,  -7.9345107,-8.47789,  -8.980036,  -9.479833, -9.917808,-10.287439,-10.617769,-10.919464, -11.168885,-11.363006,-11.487282,-11.54139, -11.579132, -11.576796,-11.521423,-11.454296,-11.326134,-11.160624, -10.9833355  -10.716831,-10.437012,-10.075199, -9.703911,  -9.257114, -8.786392, -8.356131, -7.852304, -7.3061943,  -6.72431,  -6.0890794,-5.4508805,-4.7456145,-4.0682554,  -3.3677459,-2.6665092,-1.9566059,-1.2162447,-0.5042076,0.21539927,0.96315145,1.7310619, 2.438593,  3.167808,3.875208,  4.5764446, 5.274141,  5.959213,  6.6129327,7.2551727, 7.8755856, 8.472323,  9.005284,  9.547353,  10.056949, 10.545528, 10.946298, 11.37644,  11.723399,  12.0825405,12.353552, 12.583733, 12.762033, 12.906384,  13.020968, 13.079882, 13.113999, 13.123322, 13.084221,  12.968838, 12.829447, 12.604284, 12.337184, 12.051034,  11.67034,  11.286629, 10.855663, 10.375953,  9.89821,9.375513,  8.812833,  8.2250595, 7.606089,  6.9467306,6.29164,5.615258,  4.939723,  4.263866,  3.550744,2.824688,  2.0842314, 1.3236403, 0.5562782,-0.2384901,  -1.0156393,-1.775527, -2.5006533,-3.203547, -3.9117575,  -4.616046, -5.3263545,-5.9889436,-6.638491, -7.265508,  -7.866502, -8.420145, -8.956564, -9.419716, -9.873665, -10.298967,-10.682285,-11.052191,-11.35993, -11.623394, -11.843371,-12.0259285  -12.131464,-12.252641,-12.283421, -12.286747,-12.260699,-12.176704,-12.071347,-11.9439125, -11.726093,-11.462915,-11.154758,-10.81841, -10.410023,  -9.97883,  -9.483576, -8.949841, -8.408558, -7.8505516,  -7.2529316,-6.615746, -5.9847236,-5.3057313,-4.619932,  -3.9445043,-3.2153964,-2.4859667,-1.7817855,-1.0845304,  -0.36524534,0.3444314, 1.0914087, 1.853621,  2.5703073,3.3037186, 4.0195227, 4.722297,  5.4490566, 6.0879827,6.718838,  7.3423743, 7.905209,  8.480954,  8.995235,9.479332,  9.970247, 10.371518, 10.744535, 11.024057,  11.302805, 11.54641,  11.785067, 11.972976, 12.134218,  12.248874, 12.350988, 12.401581, 12.387729, 12.296486,  12.148023, 11.98585,  11.799693, 11.589897, 11.309934,  10.965586, 10.591102, 10.185814,  9.71303,9.221673,8.656335,  8.086467,  7.47931,6.881368  ])

spls = fftpack.fft(x)
freqs = fftpack.fftfreq(len(x)) * fs

fig, ax = plt.subplots()
ax.loglog(freqs, np.abs(spls))
ax.grid(True,which='both',ls='-')
ax.set_xlim([125,8000])
plt.show()
